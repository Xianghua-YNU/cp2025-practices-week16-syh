# 项目2：地壳热扩散数值模拟 - 实验报告

**学生姓名：** [请填写]

**学号：** [请填写]

**完成日期：** [请填写]


---

## 1. 实验目的

本实验旨在通过数值方法求解地壳中的热传导方程，深入理解以下概念：

- 时变边界条件对热传导过程的影响
- 显式差分格式的稳定性和精度特点
- 地球科学中的热传导现象

**核心学习目标：**
1. 掌握显式差分格式求解抛物型偏微分方程
2. 理解季节性温度变化在地壳中的传播规律

---

## 2. 理论背景

### 2.1 热传导方程

地壳中的一维热传导方程为：

$$\frac{\partial T}{\partial t} = D \frac{\partial^2 T}{\partial z^2}$$

其中：
- $T(z,t)$ 是温度分布函数
- $z$ 是深度坐标（向下为正）
- $t$ 是时间
- $D$ 是热扩散率

### 2.2 边界条件和初始条件

**边界条件：**
- 地表 ( $z=0$ )： $T(0,t) = A + B\sin(\frac{2\pi t}{\tau})$
- 深层 ( $z=20\text{m}$ )： $T(20,t) = 11°\text{C}$

**初始条件：**
- $T(z,0) = 10°\text{C}$ （除边界点外）

**物理参数：**
- $D = 0.1 \text{ m}^2/\text{day}$ （热扩散率）
- $A = 10°\text{C}$ （年平均地表温度）
- $B = 12°\text{C}$ （地表温度振幅）
- $\tau = 365 \text{ days}$ （年周期）


## 3. 数值方法简述

### 3.1 显式差分格式(或者你采取的其他算法)

**请描述你实现的差分算法的具体形式和求解方法：**

[在此描述你的数值方法实现，包括：]
- 空间和时间离散化方案

空间离散：将深度 z 划分为 
$$\(n_z = 21\) $$
个网格点，步长 
$$\(\Delta z = 1.0 \, \text{m}\)$$
（即 
$$\(z_i = i \cdot \Delta z\)$$
，
$$\(i = 0, 1, \dots, 20\)$$
）。

时间离散：将时间 t 划分为 
$$\(n_t = 366\)$$
个时间步，步长 
$$\(\Delta t\)$$
由稳定性条件推导（见下文）。

- 差分方程的具体形式

对热传导方程离散化，得到显式更新公式：
$$\(T_i^{j+1} = T_i^j + r \cdot \left( T_{i+1}^j - 2T_i^j + T_{i-1}^j \right)\)$$

其中：

$$\(T_i^j\)$$
：第 j 时间步、第 i 深度网格的温度

$$\(r = \frac{D \cdot \Delta t}{(\Delta z)^2}\)$$
：稳定性参数（需满足 
$$\(r \leq 0.5\) $$
以保证数值稳定）

- 边界条件的处理方法

地表(i = 0)：直接代入时变边界公式
$$\(T_0^{j+1} = A + B \sin\left( \frac{2\pi (j+1)}{\tau} \right)\)$$

深层(i = 20)：固定为常数
$$\(T_{20}^j = 11^\circ\text{C} \quad (\forall j)\)$$

**稳定性分析：**

[讨论显式格式的稳定性特点，包括：]
- 稳定性参数 $r = \frac{hD}{a^2}$ 的值

显式格式的稳定性严格依赖参数 r：
$$\(r = \frac{D \cdot \Delta t}{(\Delta z)^2} \leq 0.5\)$$

- 时间步长选择的限制条件

本实验中r = 0.5（临界稳定状态），因此时间步长需满足：
$$\(\Delta t \leq \frac{0.5 \cdot (\Delta z)^2}{D}\)$$

---

## 4. 实验结果

### 4.1 数值结果

**基本计算参数：**
- 网格点数: $n_z$ =  [21]
（覆盖0m到20m）
- 时间步数: $n_t$ =  [366]
（覆盖 1 个完整年，含初始时刻）
- 模拟总时间：[1] 年
(365days)，因时间步含初始时刻，故
$$\(n_t = 366\)$$
）
- 稳定性参数: $r$ =  [0.5]
（临界稳定值，满足
$$\(r \leq 0.5\)$$
）
### 4.2 图表结果：季节性温度轮廓图

![2](https://github.com/user-attachments/assets/8a7b9419-28f1-421f-9492-1c43c4d92fbc)

**图表分析：**
- 描述四个季节温度轮廓的差异

第 0 天（冬季）：地表温度最低（接近 
$$\(10 - 12 = -2^\circ\text{C}\)$$
），深层温度稳定在 
$$\(11^\circ\text{C}\)$$

第 90 天（春季）：地表温度上升，温度梯度（曲线斜率）较大，浅部（
$$\(z < 5 \, \text{m}\)$$
）温度明显高于深层。

第 180 天（夏季）：地表温度最高（接近 
$$\(10 + 12 = 22^\circ\text{C}\)$$
），温度梯度减小，中浅层（\(z < 15 \, \text{m}\)）受季节性影响。

第 270 天（秋季）：地表温度下降，曲线趋势与春季对称，浅部温度快速回落，深层仍稳定。

- 分析温度振幅随深度的衰减规律

地表温度振幅约 \(11.98^\circ\text{C}\)（接近理论值 \(B = 12^\circ\text{C}\)），随深度增加迅速衰减：

z = 5m处：振幅已显著减小（约 
$$\(5^\circ\text{C}\) $$
量级）。

z = 20m处：振幅接近 
$$\(0^\circ\text{C}\)$$
（深层温度几乎无季节性波动）。

- 讨论季节性影响的穿透深度

季节性温度波动主要影响浅部地壳（通常z < 10m范围）。超过该深度后，温度几乎不受季节影响，维持稳定（如20m处始终为 
$$\(11^\circ\text{C}\)$$
）。

---

## 5. 分析与讨论

### 5.1 物理现象分析

**地壳热传导特征：**

浅部(z < 10m)：受季节影响显著，温度随时间呈周期性波动，振幅衰减快（因热扩散需要时间，热量尚未传递到深层）。

深部
$$\(z \geq 10 \, \text{m}\)$$
：温度季节性波动可忽略，逐渐趋近于恒定值
$$\(11^\circ\text{C}\)$$
，体现了 “热惯性”—— 深层温度对地表短期波动响应极弱。


### 5.4 思考题

**请回答以下问题：**

1. **为什么深层温度的季节性变化比地表小得多？这种现象在实际地球科学中有什么应用？**

原因：热传导需要时间，热量从地表传递到深层存在延迟；同时，深层岩石的 “热容量” 大，温度波动被 “平均化”（振幅衰减）。

应用：

地质勘探中，深层温度可作为 “稳定热源” 指示地热背景。

古气候研究中，通过浅部沉积层的温度波动反演历史气候（如冰芯、黄土层分析）。

2. **显式差分格式相比隐式格式有什么优势？在什么情况下可能选择隐式格式？**

显式格式优势：

实现简单：无需求解方程组，直接逐点更新温度。

计算高效：时间步内无矩阵运算，适合小规模问题或快速验证。

隐式格式适用场景：

当需要大时间步长（如r > 0.5时，显式格式会不稳定），隐式格式无条件稳定（但需求解线性方程组）。

模拟长时程、高精度问题时，隐式格式可避免显式格式的稳定性限制。

---

## 6. 核心代码片段（可选）

```python
def solve_earth_crust_diffusion(h=1.0, a=1.0, M=21, N=366):
    D = 0.1  # 热扩散率
    T_INITIAL = 10.0  # 初始温度
    T_BOTTOM = 11.0   # 深层温度
    A, B, TAU = 10.0, 12.0, 365.0  # 地表温度参数

    # 计算时间步长与稳定性参数
    dt = a**2 / (2 * D)
    r = D * dt / (h**2)
    print(f"稳定性参数 r = {r:.4f}")

    # 初始化温度矩阵 [depth, time]
    T = np.ones((M, N)) * T_INITIAL
    T[-1, :] = T_BOTTOM  # 深层边界条件

    # 时间步进求解（显式差分）
    for j in range(1, N):
        # 地表时变边界
        T[0, j] = A + B * np.sin(2 * np.pi * j / TAU)
        # 内部点更新（显式格式）
        T[1:-1, j] = T[1:-1, j-1] + r * (T[2:, j-1] + T[:-2, j-1] - 2 * T[1:-1, j-1])

    depth = np.linspace(0, 20, M)  # 深度网格
    return depth, T
```

